import java.nio.file.Paths

final jPackageName = 'jpackage'

tasks.register('ensurejPackageDir') {
    doLast {
        mkdir layout.buildDirectory.dir(jPackageName)
    }
}

tasks.jpackage {
    dependsOn 'ensurejPackageDir'
    dependsOn 'installDist'

    input = Paths.get(tasks.installDist.getDestinationDir().getPath(), 'lib')
    destination = "$buildDir/$jPackageName"

    appName = project.appName
    appVersion = project.version.toString()
    vendor = project.vendor

    mainJar = tasks.jar.archiveFileName.get()
    mainClass = project.application.mainClassName

    linux {
        linuxShortcut = true
    }

    windows {
        winMenu = true
        winDirChooser = true
        winShortcut = true
    }
}