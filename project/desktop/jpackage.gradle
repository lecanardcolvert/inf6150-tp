task("copyDependencies", Copy::class) {
    from(configurations.runtimeClasspath).into("$buildDir/jpackage/jar")
}

task("copyJar", Copy::class) {
    from(tasks.jar).into("$buildDir/jpackage/jar")
}

tasks.jpackage {
    dependsOn("build", "copyDependencies", "copyJar")

    input = "$buildDir/jpackage/jar"
    destination = "$buildDir/dist"

    appName = project.name
    appVersion = project.version.toString()
    vendor = "uqam.ca"

    mainJar = tasks.jar.get().archiveFileName.get()
    mainClass = project.mainClassName

    linux {
        linuxShortcut = true
    }

    windows {
        winMenu = true
        winDirChooser = true
        winShortcut = true
    }
}